<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Analytics - BevyFinder</title>
    
    <!-- Google Analytics 4 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZSY199PZC4"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-ZSY199PZC4');
    </script>
    
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        .debug-container {
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        .status-box {
            margin: 15px 0;
            padding: 15px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
        }
        .success { background: rgba(76, 175, 80, 0.3); }
        .error { background: rgba(244, 67, 54, 0.3); }
        .warning { background: rgba(255, 193, 7, 0.3); }
        .info { background: rgba(33, 150, 243, 0.3); }
        button {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 12px 20px;
            margin: 5px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }
        button:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        .log {
            background: rgba(0, 0, 0, 0.3);
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="debug-container">
        <h1>üîç BevyFinder Analytics Debug</h1>
        <p>This page will help us figure out why Google Analytics isn't showing data.</p>
        
        <div class="status-box" id="ga-status">
            <h3>Checking Google Analytics...</h3>
        </div>
        
        <div class="status-box" id="network-status">
            <h3>Checking Network Requests...</h3>
        </div>
        
        <div class="status-box" id="data-layer-status">
            <h3>Checking Data Layer...</h3>
        </div>
        
        <h3>Debug Actions:</h3>
        <button onclick="checkAnalytics()">üîç Check Analytics</button>
        <button onclick="sendTestEvent()">üì§ Send Test Event</button>
        <button onclick="checkNetwork()">üåê Check Network</button>
        <button onclick="checkDataLayer()">üìä Check Data Layer</button>
        <button onclick="clearLog()">üóëÔ∏è Clear Log</button>
        
        <h3>Debug Log:</h3>
        <div class="log" id="debug-log"></div>
        
        <h3>Common Issues:</h3>
        <ul>
            <li><strong>Ad Blockers:</strong> Disable uBlock Origin, AdBlock Plus, etc.</li>
            <li><strong>Privacy Extensions:</strong> Disable Privacy Badger, Ghostery</li>
            <li><strong>Browser Settings:</strong> Check if tracking protection is enabled</li>
            <li><strong>Network Issues:</strong> Check if googletagmanager.com is blocked</li>
            <li><strong>GA4 Setup:</strong> Verify your property is properly configured</li>
        </ul>
        
        <h3>Quick Fixes:</h3>
        <ol>
            <li>Try opening this page in an incognito/private window</li>
            <li>Disable all browser extensions temporarily</li>
            <li>Check your Google Analytics property settings</li>
            <li>Wait 24-48 hours for data to appear in standard reports</li>
        </ol>
    </div>

    <script>
        let logCount = 0;
        
        function log(message, type = 'info') {
            const logDiv = document.getElementById('debug-log');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${message}\n`;
            logDiv.textContent += logEntry;
            logDiv.scrollTop = logDiv.scrollHeight;
            logCount++;
        }
        
        function clearLog() {
            document.getElementById('debug-log').textContent = '';
            logCount = 0;
        }
        
        function updateStatus(elementId, message, type) {
            const element = document.getElementById(elementId);
            element.innerHTML = `<h3>${message}</h3>`;
            element.className = `status-box ${type}`;
        }
        
        function checkAnalytics() {
            log('Checking Google Analytics availability...');
            
            if (typeof gtag !== 'undefined') {
                updateStatus('ga-status', '‚úÖ Google Analytics is loaded!', 'success');
                log('‚úÖ gtag function is available');
                
                // Test if we can send an event
                try {
                    gtag('event', 'debug_test', {
                        'event_category': 'debug',
                        'event_label': 'analytics_check'
                    });
                    log('‚úÖ Successfully sent test event to GA4');
                } catch (error) {
                    log(`‚ùå Error sending test event: ${error.message}`, 'error');
                }
            } else {
                updateStatus('ga-status', '‚ùå Google Analytics is NOT loaded!', 'error');
                log('‚ùå gtag function is not available', 'error');
            }
        }
        
        function sendTestEvent() {
            log('Sending test event to Google Analytics...');
            
            if (typeof gtag !== 'undefined') {
                gtag('event', 'debug_event', {
                    'event_category': 'debug',
                    'event_label': 'manual_test',
                    'value': 1
                });
                log('‚úÖ Test event sent: debug_event');
                updateStatus('ga-status', '‚úÖ Test event sent! Check Real-time reports.', 'success');
            } else {
                log('‚ùå Cannot send event - gtag not available', 'error');
            }
        }
        
        function checkNetwork() {
            log('Checking network requests...');
            
            // Check if we can reach Google Analytics
            fetch('https://www.googletagmanager.com/gtag/js?id=G-ZSY199PZC4', { mode: 'no-cors' })
                .then(() => {
                    log('‚úÖ Network request to googletagmanager.com successful');
                    updateStatus('network-status', '‚úÖ Network connection OK', 'success');
                })
                .catch((error) => {
                    log(`‚ùå Network request failed: ${error.message}`, 'error');
                    updateStatus('network-status', '‚ùå Network connection failed', 'error');
                });
        }
        
        function checkDataLayer() {
            log('Checking data layer...');
            
            if (window.dataLayer && Array.isArray(window.dataLayer)) {
                log(`‚úÖ Data layer exists with ${window.dataLayer.length} entries`);
                log(`Data layer content: ${JSON.stringify(window.dataLayer, null, 2)}`);
                updateStatus('data-layer-status', `‚úÖ Data layer OK (${window.dataLayer.length} entries)`, 'success');
            } else {
                log('‚ùå Data layer is not properly initialized', 'error');
                updateStatus('data-layer-status', '‚ùå Data layer not found', 'error');
            }
        }
        
        // Auto-run checks on page load
        window.addEventListener('load', () => {
            log('Page loaded, running initial checks...');
            setTimeout(() => {
                checkAnalytics();
                checkNetwork();
                checkDataLayer();
            }, 2000);
        });
        
        // Monitor for gtag calls
        const originalGtag = window.gtag;
        if (typeof originalGtag === 'function') {
            window.gtag = function(...args) {
                log(`gtag called: ${JSON.stringify(args)}`);
                return originalGtag.apply(this, args);
            };
        }
    </script>
</body>
</html> 